{#
    basic/searchbox.html
    ~~~~~~~~~~~~~~~~~~~~

    Sphinx sidebar template: quick search box.

    :copyright: Copyright 2007-2016 by the Sphinx team, see AUTHORS.
    :license: BSD, see LICENSE for details.
#}
{%- if pagename != "search" and builder != "singlehtml" %}
<button id="search-opener" class="search-opener search-control" type="button" aria-expanded="false" aria-controls="searchbox">
    <i class="fa fa-search search-complete__icon" aria-hidden="true"></i>
    <span class="sr-text">Open search form</span>
</button>
<div id="searchbox" class="collapsed" aria-hidden="true" role="search">
<!--    <form class="search" action="{{ pathto('search') }}" method="get">-->
    <form class="search">
        <div class="search-container">
            <input class="search_text" type="text" placeholder="Search in documentation " name="q" />
            <span class="icon-submit">
                <i class="fa fa-search search-complete__icon" aria-hidden="true"></i>
            </span>
            <button id="search-close" class="search-close search-control" type="button" aria-expanded="false" aria-controls="searchbox">
                <i class="reset__icon" aria-hidden="true"></i>
                <span class="sr-text">Hide search form</span>
            </button>
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
{% set algoliaOptions = '{}' %}
{% if oro_current_version %}
    {% set algoliaOptions = "{ 'facetFilters': [\"version:" ~ oro_current_version ~ "\"] }" %}
{% endif %}
<script>
    docsearch({
        appId: 'BH4D9OD16A',
        apiKey: 'e3c892f37816d9486c2ed56fca7a67bb',
        indexName: 'oroinc',
        inputSelector: '#searchbox input[type=text]',
        algoliaOptions: {{ algoliaOptions }},
        debug: false
    });
</script>

<script type="text/javascript">
    $('.header-search .search-control').on('click', function () {
        var searchForm = $('#searchbox');

        if (searchForm.hasClass('collapsed')){
            searchForm
                    .attr('aria-hidden' , false)
                    .removeClass('collapsed');
            $('.header-search .search-control').attr('aria-expanded' , true);
            $('.header-search .search_text').focus();
        } else {
            searchForm
                    .removeAttr('aria-hidden' , true)
                    .addClass('collapsed');
            $('.header-search .search-control').attr('aria-expanded' , false);
            $('.header-search .search_text').blur();
        }
    });

    $('.header-search .search_text').keypress(function(e) {
        if (e.keyCode === 13) {
            e.preventDefault();
            return false;
        }
    });
</script>


{%- endif %}
